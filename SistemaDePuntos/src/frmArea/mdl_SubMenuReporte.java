/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package frmArea;

import Conexion.Conexion;
import java.awt.Toolkit;
import java.io.IOException;
import java.net.URL;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JDialog;
import javax.swing.JOptionPane;
import jxl.write.WriteException;
import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.engine.util.JRLoader;
import net.sf.jasperreports.view.JasperViewer;

/**
 *
 * @author Luis Estrada
 */
public class mdl_SubMenuReporte extends java.awt.Dialog {

    /**
     * Creates new form mdl_SubMenuReporte
     */
    public mdl_SubMenuReporte(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        this.setLocationRelativeTo(null); //para ponerse en el centro
        this.setResizable(false); //Desactivar botón maximizar de una ventana
        setIconImage(new ImageIcon(getClass().getResource("../imgSP/icono.png")).getImage()); //cambia el icono del formulario
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jpanel_reporte = new javax.swing.JPanel();
        btn_cliente = new javax.swing.JButton();
        brn_puntos = new javax.swing.JButton();
        jl_TituloPrincipal = new javax.swing.JLabel();
        brn_rangoDeEdad = new javax.swing.JButton();
        btn_graficas1 = new javax.swing.JButton();
        btn_report2 = new javax.swing.JButton();
        btn_report3 = new javax.swing.JButton();
        btnGenerarExcel = new javax.swing.JButton();

        setMaximumSize(new java.awt.Dimension(577, 357));
        setMinimumSize(new java.awt.Dimension(577, 357));
        setTitle("Menú de Reportes y Graficas");
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                closeDialog(evt);
            }
        });
        setLayout(null);

        jpanel_reporte.setMinimumSize(new java.awt.Dimension(680, 530));
        jpanel_reporte.setLayout(null);

        btn_cliente.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgSP/cliente.png"))); // NOI18N
        btn_cliente.setText("Clientes");
        btn_cliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_clienteActionPerformed(evt);
            }
        });
        jpanel_reporte.add(btn_cliente);
        btn_cliente.setBounds(220, 120, 160, 60);

        brn_puntos.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgSP/estadistica puntos.png"))); // NOI18N
        brn_puntos.setText("Puntos");
        brn_puntos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                brn_puntosActionPerformed(evt);
            }
        });
        jpanel_reporte.add(brn_puntos);
        brn_puntos.setBounds(40, 120, 160, 60);

        jl_TituloPrincipal.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jl_TituloPrincipal.setText("Menú de Reportes");
        jpanel_reporte.add(jl_TituloPrincipal);
        jl_TituloPrincipal.setBounds(180, 50, 230, 30);

        brn_rangoDeEdad.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgSP/rango_Edad.png"))); // NOI18N
        brn_rangoDeEdad.setText("Edad");
        brn_rangoDeEdad.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                brn_rangoDeEdadActionPerformed(evt);
            }
        });
        jpanel_reporte.add(brn_rangoDeEdad);
        brn_rangoDeEdad.setBounds(400, 120, 160, 60);

        btn_graficas1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgSP/grafica.png"))); // NOI18N
        btn_graficas1.setText("Graficas");
        btn_graficas1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_graficas1ActionPerformed(evt);
            }
        });
        jpanel_reporte.add(btn_graficas1);
        btn_graficas1.setBounds(400, 200, 160, 60);

        btn_report2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgSP/zona.png"))); // NOI18N
        btn_report2.setText("Zona");
        btn_report2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_report2ActionPerformed(evt);
            }
        });
        jpanel_reporte.add(btn_report2);
        btn_report2.setBounds(220, 200, 160, 60);

        btn_report3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgSP/rango_tipo_Edad.png"))); // NOI18N
        btn_report3.setText("Rango por Edad");
        btn_report3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_report3ActionPerformed(evt);
            }
        });
        jpanel_reporte.add(btn_report3);
        btn_report3.setBounds(40, 200, 160, 60);

        btnGenerarExcel.setText("Reporte Excel");
        btnGenerarExcel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGenerarExcelActionPerformed(evt);
            }
        });
        jpanel_reporte.add(btnGenerarExcel);
        btnGenerarExcel.setBounds(220, 280, 160, 60);

        add(jpanel_reporte);
        jpanel_reporte.setBounds(0, 0, 580, 360);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    /**
     * Closes the dialog
     */
    private void closeDialog(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_closeDialog
        setVisible(false);
        dispose();
    }//GEN-LAST:event_closeDialog

    private void btn_clienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_clienteActionPerformed
       // TODO add your handling code here:
        Conexion con= new Conexion();
        
        try{
            con.getConexion();
        }catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Error" + e.getMessage(),
                    "Error de conexion", JOptionPane.ERROR_MESSAGE);
        }
        
        URL archivo = this.getClass().getResource("/reportes/report_cliente.jasper");
        
        
        try {
             
            JasperReport jr = (JasperReport) JRLoader.loadObject(archivo);
            JasperPrint jp = JasperFillManager.fillReport(jr,null, Conexion.getConexion());
            JasperViewer jv = new JasperViewer(jp,false);
            JDialog dialog = new JDialog(this);
            dialog.setContentPane(jv.getContentPane());
            dialog.setSize(jv.getSize());
            dialog.setTitle("Visor de Reporte Farmacia Regis - Las Casitas");
            dialog.setIconImage(Toolkit.getDefaultToolkit().getImage(
            getClass().getResource("../imgSP/icono.png")));
            dialog.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(mdl_SubMenuReporte.class.getName()).log(Level.SEVERE, null, ex);
            System.out.println(ex);
        }
        
        
    }//GEN-LAST:event_btn_clienteActionPerformed

    private void brn_puntosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_brn_puntosActionPerformed
               // TODO add your handling code here:
        Conexion con= new Conexion();
        
        try{
            con.getConexion();
        }catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Error" + e.getMessage(),
                    "Error de conexion", JOptionPane.ERROR_MESSAGE);
        }
        
        URL archivo = this.getClass().getResource("/reportes/report_cliente_x_zona.jasper");
        
        
        try {
             
            JasperReport jr = (JasperReport) JRLoader.loadObject(archivo);
            JasperPrint jp = JasperFillManager.fillReport(jr,null, Conexion.getConexion());
            JasperViewer jv = new JasperViewer(jp,false);
            JDialog dialog = new JDialog(this);
            dialog.setContentPane(jv.getContentPane());
            dialog.setSize(jv.getSize());
            dialog.setTitle("Visor de Reporte Farmacia Regis - Las Casitas");
            dialog.setIconImage(Toolkit.getDefaultToolkit().getImage(
            getClass().getResource("../imgSP/icono.png")));
            dialog.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(mdl_SubMenuReporte.class.getName()).log(Level.SEVERE, null, ex);
            System.out.println(ex);
        }
    }//GEN-LAST:event_brn_puntosActionPerformed

    private void brn_rangoDeEdadActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_brn_rangoDeEdadActionPerformed
/*        frmMenuPrincipal frmMenuPrincipal =  new frmMenuPrincipal();
        mdl_consultar_por_rango_de_edad ver=new mdl_consultar_por_rango_de_edad(frmMenuPrincipal,true);
        ver.setVisible(true); // visible ventana del objeto*/
    }//GEN-LAST:event_brn_rangoDeEdadActionPerformed

    private void btn_graficas1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_graficas1ActionPerformed
         
    }//GEN-LAST:event_btn_graficas1ActionPerformed

    private void btn_report2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_report2ActionPerformed
        frmMenuPrincipal frmMenuPrincipal=new frmMenuPrincipal();
        mdl_reporte_zona_por_puntaje ver=new mdl_reporte_zona_por_puntaje(frmMenuPrincipal,true);
        ver.setVisible(true); // visible ventana del objeto
    }//GEN-LAST:event_btn_report2ActionPerformed

    private void btn_report3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_report3ActionPerformed
         frmMenuPrincipal frmMenuPrincipal=new frmMenuPrincipal();
        mdl_consultar_por_rango_de_edad ver=new mdl_consultar_por_rango_de_edad(frmMenuPrincipal,true);
            ver.setVisible(true); // visible ventana del objeto
            
    }//GEN-LAST:event_btn_report3ActionPerformed

    private void btnGenerarExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGenerarExcelActionPerformed
        try {
            Clases.GenerarExcel.WriteExcel();
        } catch (IOException ex) {
            Logger.getLogger(mdl_SubMenuReporte.class.getName()).log(Level.SEVERE, null, ex);
        } catch (WriteException ex) {
            Logger.getLogger(mdl_SubMenuReporte.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnGenerarExcelActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                mdl_SubMenuReporte dialog = new mdl_SubMenuReporte(new java.awt.Frame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton brn_puntos;
    private javax.swing.JButton brn_rangoDeEdad;
    private javax.swing.JButton btnGenerarExcel;
    private javax.swing.JButton btn_cliente;
    private javax.swing.JButton btn_graficas1;
    private javax.swing.JButton btn_report2;
    private javax.swing.JButton btn_report3;
    private javax.swing.JLabel jl_TituloPrincipal;
    private javax.swing.JPanel jpanel_reporte;
    // End of variables declaration//GEN-END:variables
}
